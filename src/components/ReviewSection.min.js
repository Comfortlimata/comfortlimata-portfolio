import{useState as e,useEffect as t,useRef as r,useMemo as l}from"react";import{motion as o,AnimatePresence as a}from"framer-motion";let reviewsJSON=[],ReviewSection=()=>{let[o,a]=e(reviewsJSON),[i,n]=e(0),[$,s]=e(0),[g,x]=e(""),[u,m]=e(""),[f,h]=e(0),w=r(null),d=l(()=>{let e={1:0,2:0,3:0,4:0,5:0};for(let t of o)t?.stars>=1&&t?.stars<=5&&(e[t.stars]+=1);let r=o.length,l=Object.entries(e).map(([e,t])=>({stars:Number(e),count:t,pct:r?Math.round(t/r*100):0}));return l.sort((e,t)=>t.count-e.count||t.stars-e.stars),{total:r,entries:l}},[o]);t(()=>{if(0!==o.length)return clearTimeout(w.current),w.current=setTimeout(()=>{h(e=>(e+1)%o.length)},5e3),()=>clearTimeout(w.current)},[f,o.length]);let y=e=>{e.preventDefault(),i&&g&&u&&(a([{name:u,stars:i,comment:g,date:new Date().toLocaleDateString()},...o,]),n(0),s(0),x(""),m(""),h(0))},c=()=>o.length&&h(e=>(e+1)%o.length),b=()=>o.length&&h(e=>(e-1+o.length)%o.length);return<section className="py-12 px-4 bg-gradient-to-b from-gray-900 to-dark-bg rounded-xl shadow-2xl max-w-2xl mx-auto">

      <form className="flex flex-col gap-4 bg-gray-800 p-6 rounded-xl shadow-lg mb-10"onSubmit={y}>

        <h2 className="text-2xl font-bold text-center text-primary mb-4">Leave a Review</h2>

        <div className="flex items-center justify-center gap-2 mb-2">

          {[1,2,3,4,5].map(e=><span key={e}className={`text-3xl cursor-pointer ${e<=($||i)?"text-yellow-400":"text-gray-400"} hover:scale-110 transition-transform`}onClick={()=>n(e)}onMouseEnter={()=>s(e)}onMouseLeave={()=>s(0)}aria-label={`Rate ${e} star${e>1?"s":""}`}role="button"tabIndex={0}>★</span>)}

        </div>

        <input className="w-full p-3 rounded-lg bg-gray-900 text-white focus:outline-none focus:ring-2 focus:ring-primary"placeholder="Your Name"value={u}onChange={e=>m(e.target.value)}required/>

        <textarea className="w-full p-3 rounded-lg bg-gray-900 text-white focus:outline-none focus:ring-2 focus:ring-primary"rows="3"placeholder="Share your thoughts..."value={g}onChange={e=>x(e.target.value)}required/>

        <button type="submit"className="bg-primary text-dark-bg px-6 py-2 rounded-full font-semibold hover:bg-opacity-90 transition mt-2"disabled={!i||!g||!u}>

          Submit Review

        </button>

      </form>



      <div className="mb-4 flex items-center justify-center gap-3">

        <h3 className="text-xl font-semibold text-white">Reviews</h3>

        {o.length>0?<span aria-live="polite"className="inline-flex items-center rounded-full bg-white/10 text-white text-xs px-3 py-1 border border-white/10">

            {o.length} {1===o.length?"Review":"Reviews"}

          </span>:<span aria-live="polite"className="text-sm text-gray-400">No reviews yet — be the first!</span>}

      </div>

      {o.length>0&&<div className="max-w-xl mx-auto w-full mb-6 space-y-2">

          {d.entries.map(e=><div key={e.stars}className="flex items-center gap-3">

              <span className="w-10 text-sm text-gray-300">{e.stars}★</span>

              <div className="flex-1 h-2 rounded-full bg-white/10 overflow-hidden">

                <div className="h-full bg-primary"style={{width:`${e.pct}%`}}/>

              </div>

              <span className="w-10 text-right text-xs text-gray-400">{e.count}</span>

            </div>)}

        </div>}

      <div className="relative flex flex-col items-center">

        <button onClick={b}className="absolute left-0 top-1/2 -translate-y-1/2 bg-gray-700 hover:bg-primary text-white rounded-full p-2 shadow-lg z-10"aria-label="Previous Review"disabled={0===o.length}>

          ←

        </button>

        <div className="w-full max-w-xl flex justify-center">

          <a mode="wait">

            <o.div key={f}initial={{opacity:0,x:100}}animate={{opacity:1,x:0}}exit={{opacity:0,x:-100}}transition={{duration:.5}}className="bg-gray-800 rounded-xl p-8 shadow-lg w-full">

              <div className="flex items-center gap-2 mb-2">

                {[1,2,3,4,5].map(e=><span key={e}className={`text-xl ${e<=(o[f]?.stars||0)?"text-yellow-400":"text-gray-600"}`}>★</span>)}

                <span className="ml-2 text-sm text-gray-400">{o[f]?.date||""}</span>

              </div>

              <p className="text-lg text-white mb-2">{o[f]?.comment||"No reviews yet. Be the first to leave a review."}</p>

              <div className="text-right text-primary font-bold">{o[f]?.name||""}</div>

            </o.div>

          </a>

        </div>

        <button onClick={c}className="absolute right-0 top-1/2 -translate-y-1/2 bg-gray-700 hover:bg-primary text-white rounded-full p-2 shadow-lg z-10"aria-label="Next Review"disabled={0===o.length}>

          →

        </button>

      </div>

    </section>};export default ReviewSection;